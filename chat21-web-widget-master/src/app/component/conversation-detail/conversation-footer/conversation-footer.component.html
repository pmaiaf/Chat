<div id="floating-container" *ngIf="hideTextAreaContent" class="fade-in-bottom" start-focus-chat21-conversation-component> 
    <button tabindex="1040" aflistconv #aflistconv  class="c21-button-primary" (click)="openNewConversation()" [ngStyle]="{'background-color': stylesMap.get('themeColor'), 'border-color': stylesMap.get('themeColor'), 'color': stylesMap?.get('foregroundColor')}">
        <span class="v-align-center">
          <svg [ngStyle]="{'fill': 'yellow' }" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"  [ngStyle]="{'fill': stylesMap?.get('foregroundColor')}"/>
          </svg>
        </span>
        <span class="v-align-center c21-label-button">
          {{translationMap?.get('LABEL_START_NW_CONV')}}
        </span>  
        <div class="clear"></div>
    </button>
    <button *ngIf="showContinueConversationButton" tabindex="1040"  class="c21-button-primary" (click)="onContinueConversation()" [ngStyle]="{'background-color': stylesMap.get('themeColor'), 'border-color': stylesMap.get('themeColor'), 'color': stylesMap?.get('foregroundColor')}">
        <span class="v-align-center c21-label-button">
          {{translationMap?.get('CONTINUE')}}
        </span>  
        <div class="clear"></div>
    </button>
</div>

<div class="visible-text-area"  *ngIf="!hideTextAreaContent" [class.disabled] = "( isConversationArchived || hideTextReply)? true : null">
    <!-- isFilePendingToUpload || -->
  <textarea 
    [attr.disabled] = "(hideTextReply)? true : null"
    [attr.placeholder] ="(footerMessagePlaceholder)? footerMessagePlaceholder : translationMap?.get('LABEL_PLACEHOLDER')"
    start-focus-chat21-conversation-component
    inputTextArea
    #textbox 
    tabindex="1501"
    aria-labelledby="altTextArea"
    rows="1"
    id="chat21-main-message-context"
    class='f21textarea c21-button-clean'
    [(ngModel)]="textInputTextArea"
    (ngModelChange)="onTextAreaChange()"
    (keypress)="onkeypress($event)"
    (keydown)="onkeydown($event)"
    (paste)="onPaste($event)">
    <!-- placeholder="{{ translationMap?.get('LABEL_PLACEHOLDER') }}"> -->
  </textarea>

</div>
<!--   -->
<div #div_attached  *ngIf="!hideTextAreaContent">
    <!-- ICON ATTACHMENT -->
    <label *ngIf="showAttachmentButton == true" tabindex="1502" aria-label="allegati" for="chat21-file" class="chat21-textarea-button" [class.active]="!isFilePendingToUpload && !hideTextReply" id="chat21-start-upload-doc">
        <span class="v-align-center">
            <svg xmlns="http://www.w3.org/2000/svg"  width="24" height="24" viewBox="0 0 28 28" transform="rotate(45)">
                <!-- <path [ngStyle]="{'fill': stylesMap?.get('themeColor') }" d="M0 0h24v24H0V0z"/> -->
                <path d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z" />
            </svg>
        </span>
        <!-- accept="image/*, audio/* ,video/*, .pdf, .zip" -->
        <input
            [attr.disabled] = "(isFilePendingToUpload || isConversationArchived || hideTextReply)? true : null"
            tabindex="1503" 
            type="file" 
            aria-label="seleziona allegato"
            [accept]="fileUploadAccept"
            name="chat21-file"
            id="chat21-file"
            #chat21_file
            class="inputfile" 
            [ngStyle]="{'display': 'block', height:'1px', width:'1px', overflow: 'hidden' }"
            (change)="detectFiles($event)"/>
    </label>
    <!-- ICON SEND -->
    <!-- <div [class.active]="isFileSelected && !isFilePendingToUpload &&" class="chat21-textarea-button" id="chat21-button-reset" (click)="resetLoadImage()"></div> -->
    <div tabindex="-1" class="chat21-textarea-button" [class.active]="textInputTextArea && !hideTextReply" id="chat21-button-send" (click)="onSendPressed($event)">
        <!-- <span class="v-align-center">
            <svg xmlns="http://www.w3.org/2000/svg" [ngStyle]="{'fill': stylesMap?.get('themeColor') }" width="24" height="24" viewBox="0 0 28 28">
                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
            </svg>
        </span>  -->
        <span class="v-align-center">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  height="24" width="24" viewBox="0 0 24 24" style="enable-background:new 0 0 24 24;" xml:space="preserve">
                <path d="M1.8,18.9V1.7L22,10.3L1.8,18.9z M3.9,15.6l12.6-5.4L3.9,4.9v3.7l6.4,1.6l-6.4,1.6V15.6z M3.9,15.6V4.9v7V15.6z"/>
            </svg>
        </span>
    </div>
    <!-- ICON EMOJII -->
    <label tabindex="1504" aria-label="emojii" for="chat21-emojii" class="chat21-textarea-button" [class.active]="!isFilePendingToUpload && !hideTextReply" id="chat21-emoticon-picker" (click)="onEmojiiPickerClicked()">
        <span class="v-align-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 28 28" >
                <path d="M0 0h24v24H0V0z" fill="none"/>
                <circle cx="15.5" cy="9.5" r="1.5"/>
                <circle cx="8.5" cy="9.5" r="1.5"/>
                <path d="M12 16c-1.48 0-2.75-.81-3.45-2H6.88c.8 2.05 2.79 3.5 5.12 3.5s4.32-1.45 5.12-3.5h-1.67c-.7 1.19-1.97 2-3.45 2zm-.01-14C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"/>
            </svg>
        </span>
    </label>
</div>
<!-- <div id="button" data-testid="widgetButton" class="chat-open">
    <button type="button" id="button-body" tabindex="0" [ngStyle]="{'background':  'linear-gradient( 180grad,' + stylesMap.get('themeColor')+','+ convertColorToRGBA(stylesMap.get('themeColor'), 50)+')'}">
        <svg fill="#FFFFFF" height="20" width="20" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path>
            <path d="M0 0h24v24H0z" fill="none"></path>
        </svg>
    </button>
</div> -->


<!-- <div #div_mic *ngIf="g.showMicButton" id="playbutton">
  <button *ngIf="!isRecording"  tabindex="1502" aria-label="microfono" for="chat21-file" [class.active]="true" class="chat21-textarea-button c21-button-clean" id="chat21-start-mic" (click)="toggleRecording($event)">
      <span class="v-align-center">
          <svg aria-label="registra traccia audio" xmlns="http://www.w3.org/2000/svg" [ngStyle]="{'fill': g.themeColor}" width="24" height="24" viewBox="0 0 28 28">
              <path d="M12,14c1.66,0,3-1.34,3-3V5c0-1.66-1.34-3-3-3S9,3.34,9,5v6C9,12.66,10.34,14,12,14z"/>
              <path d="M17,11c0,2.76-2.24,5-5,5s-5-2.24-5-5H5c0,3.53,2.61,6.43,6,6.92V21h2v-3.08c3.39-0.49,6-3.39,6-6.92H17z"/>    
          </svg>
      </span>
  </button>
  <button  *ngIf="isRecording" tabindex="1502" aria-label="stop registrazione" for="chat21-file" [class.active]="true" class="chat21-textarea-button c21-button-clean " id="chat21-start-mic" (click)="toggleRecording($event)" autofocus> 
      <span class="v-align-center">
          <svg aria-label="termina registrazione" xmlns="http://www.w3.org/2000/svg" [ngStyle]="{'fill': g.themeColor}" width="24" height="24" viewBox="0 0 28 28">
              <path d="M0 0h24v24H0z" fill="none"/>
              <path d="M6 6h12v12H6z"/>
          </svg>
      </span>
  </button>
</div> -->


<!-- <div [class.active]="isFileSelected" class="name-image" id="chat21-file-selected">
  <span>{{nameFile}}</span>
</div> -->
<!-- <span id="testFocus" tabindex="1599" *ngIf="!isConversationArchived" onFocus="document.querySelector('[start-focus-chat21-conversation-component]').focus()"></span> -->
<!-- <span id="altTextArea" style="display: none">scrivi la tua domanda</span> -->


<div [style.visibility]="isEmojiiPickerShow?'visible':'hidden'"  class="emoji-container">
    <emoji-mart id="emoji-mart"
        *ngIf="showEmojiPicker"
        class="emoji-mart"
        [showPreview]="emojiiOptions.showPreview"
        [color]="stylesMap?.get('themeColor')" 
        [perLine]="emojiiOptions.emojiPerLine"
        [totalFrequentLines]="emojiiOptions.totalFrequentLines"
        [enableSearch]="emojiiOptions.enableSearch"
        [darkMode]="emojiiOptions.darkMode"
        [include]="emojiiOptions.include"
        (emojiSelect)="addEmoji($event)">
    </emoji-mart>
</div>
